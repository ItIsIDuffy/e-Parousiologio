const a0_0x40a867=a0_0x2979;function a0_0x2979(_0x243cd6,_0x335230){const _0x4e3b39=a0_0x4e3b();return a0_0x2979=function(_0x297950,_0x4d93af){_0x297950=_0x297950-0x77;let _0x6f4fdc=_0x4e3b39[_0x297950];return _0x6f4fdc;},a0_0x2979(_0x243cd6,_0x335230);}(function(_0x179ff5,_0x4b5fe0){const _0x12672c=a0_0x2979,_0x5f092a=_0x179ff5();while(!![]){try{const _0x5b0470=-parseInt(_0x12672c(0xd3))/0x1*(-parseInt(_0x12672c(0xa5))/0x2)+-parseInt(_0x12672c(0xd0))/0x3+-parseInt(_0x12672c(0x89))/0x4*(parseInt(_0x12672c(0xac))/0x5)+-parseInt(_0x12672c(0xd2))/0x6*(-parseInt(_0x12672c(0x98))/0x7)+parseInt(_0x12672c(0xb5))/0x8*(parseInt(_0x12672c(0xcf))/0x9)+parseInt(_0x12672c(0x77))/0xa*(-parseInt(_0x12672c(0x8a))/0xb)+parseInt(_0x12672c(0xc2))/0xc;if(_0x5b0470===_0x4b5fe0)break;else _0x5f092a['push'](_0x5f092a['shift']());}catch(_0x2f160e){_0x5f092a['push'](_0x5f092a['shift']());}}}(a0_0x4e3b,0x30b52));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';import{getFirestore,doc,getDoc,setDoc,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';const firebaseConfig={'apiKey':a0_0x40a867(0xda),'authDomain':a0_0x40a867(0xdb),'projectId':'parousiologio-6b9c0','storageBucket':a0_0x40a867(0x7c),'messagingSenderId':a0_0x40a867(0xdc),'appId':a0_0x40a867(0xc8),'measurementId':a0_0x40a867(0x81)},app=initializeApp(firebaseConfig),db=getFirestore(app),TARGET={'lat':41.0748233,'lng':23.555335},RADIUS_M=0x96,$=_0x38bf2b=>document[a0_0x40a867(0xb3)](_0x38bf2b),courseNameEl=$(a0_0x40a867(0xcd)),sectionNameEl=$(a0_0x40a867(0xd9)),aemForm=$(a0_0x40a867(0xc1)),retryBtn=$(a0_0x40a867(0x8c)),statusBanner=$(a0_0x40a867(0xd5)),statusBannerHint=$('#statusBannerHint'),bannerSpinner=$(a0_0x40a867(0xd4)),actionBlock=$(a0_0x40a867(0xa8)),setStatus=(_0x618015,_0x24770d,_0x394757=![],_0x5efb2e=![])=>{const _0x509789=a0_0x40a867;statusBannerHint[_0x509789(0x7b)]=_0x24770d,statusBanner[_0x509789(0xde)][_0x509789(0x91)]('is-info',_0x509789(0x8d),_0x509789(0xb6),_0x509789(0xc6)),statusBanner[_0x509789(0xde)][_0x509789(0x80)](_0x509789(0xbf)+_0x618015),show(statusBanner,!![]),show(actionBlock,_0x394757),show(bannerSpinner,_0x5efb2e);},show=(_0x11281d,_0x1a3a55)=>_0x11281d['classList']['toggle'](a0_0x40a867(0xa9),!_0x1a3a55),pad2=_0x367d99=>_0x367d99['toString']()[a0_0x40a867(0xba)](0x2,'0');function a0_0x4e3b(){const _0x2257ee=['is-warn','Δεν\x20έχει\x20οριστεί\x20σωστά\x20το\x20ενεργό\x20τμήμα.','message','Η\x20καταχώριση\x20απέτυχε.\x20Προσπαθήστε\x20ξανά.','padStart','code','getUTCDate','sin','labId','is-','labName','#aemForm','8419272zwCAbh','\x22\x20καταχωρήθηκε.','number','Παρουσιάστηκε\x20σφάλμα\x20στην\x20τοποθεσία.\x20Παρακαλούμε\x20δοκιμάστε\x20ξανά.','is-error','Δεν\x20υπάρχει\x20ενεργό\x20τμήμα\x20αυτή\x20τη\x20στιγμή.','1:398482455434:web:3db85dc9dd42ece2832673','longitude','Έληξε\x20ο\x20χρόνος\x20εντοπισμού.\x20Παρακαλούμε\x20βεβαιωθείτε\x20ότι\x20η\x20τοποθεσία\x20είναι\x20ενεργή.','students','Η\x20τοποθεσία\x20είναι\x20διαθέσιμη\x20μόνο\x20μέσω\x20HTTPS.','#courseName','Ο\x20περιηγητής\x20σας\x20δεν\x20υποστηρίζει\x20ή\x20έχει\x20απενεργοποιήσει\x20την\x20υπηρεσία\x20τοποθεσίας.','1827009qnuHia','1147422hoOJJW','lat','141270updLGF','343344dVMTXx','#bannerSpinner','#statusBanner','Έχετε\x20ήδη\x20δηλώσει\x20παρουσία\x20για\x20το\x20σημερινό\x20τμήμα.','Η\x20υπηρεσία\x20τοποθεσίας\x20δεν\x20είναι\x20διαθέσιμη\x20αυτή\x20τη\x20στιγμή.','success','#sectionName','AIzaSyCGi9p53Y_RMSIwjPrs7V8oyKdk_YNlyTs','parousiologio-6b9c0.firebaseapp.com','398482455434','warn','classList','(κλειστό)','info','550pECccF','openedAt','submit','(κανένα)','textContent','parousiologio-6b9c0.appspot.com','preventDefault','#aem','error','add','G-HEZ5MM3E15','click','out-of-zone','Έληξε\x20ο\x20χρόνος\x20εντοπισμού.\x20Παρακαλούμε\x20δοκιμάστε\x20ξανά.','lng','getUTCFullYear','Η\x20παρουσία\x20σας\x20στο\x20τμήμα\x20\x22','courseId','511988DzHgQa','61105XzkbCC','getCurrentPosition','#retryBtn','is-success','attendance','latitude','geolocation','remove','(ενεργό)','(—)','sqrt','Ο\x20ΑΕΜ\x20δεν\x20ανήκει\x20στο\x20επιλεγμένο\x20τμήμα.','isOpen','exists','7HsBQXG','entries','disabled','timeout','cos','Παρουσιάστηκε\x20πρόβλημα\x20με\x20την\x20ενεργή\x20ρύθμιση\x20τμήματος.\x20Παρακαλούμε\x20δοκιμάστε\x20ξανά\x20αργότερα.','value','courseTitle','live','courses','race','write\x20error:','no-geo','2hIxFTS','labs','data','#actionBlock','hidden','reset','Το\x20σύστημα\x20παρουσιών\x20είναι\x20κλειστό\x20αυτή\x20τη\x20στιγμή.','15RVnQnG','Δώστε\x20έγκυρο\x20ΑΕΜ\x20(μόνο\x20ψηφία,\x204–12).','insecure-context','Είστε\x20εκτός\x20επιτρεπόμενης\x20ζώνης\x20για\x20δήλωση\x20παρουσίας.','coords','https:','Παρουσιάστηκε\x20σφάλμα\x20κατά\x20την\x20αρχικοποίηση.\x20Παρακαλούμε\x20δοκιμάστε\x20ξανά.','querySelector','addEventListener','8NmCTuc'];a0_0x4e3b=function(){return _0x2257ee;};return a0_0x4e3b();}async function getLiveState(){const _0x17ec5c=a0_0x40a867,_0x58bfa2=await getDoc(doc(db,'app_state',_0x17ec5c(0xa0)));if(!_0x58bfa2[_0x17ec5c(0x97)]())return null;const _0x311f34=_0x58bfa2[_0x17ec5c(0xa7)]();return{'courseId':_0x311f34[_0x17ec5c(0x88)]||null,'courseTitle':_0x311f34[_0x17ec5c(0x9f)]||_0x311f34[_0x17ec5c(0x88)]||_0x17ec5c(0x93),'labId':_0x311f34['labId']||null,'labName':_0x311f34[_0x17ec5c(0xc0)]||'(—)','isOpen':_0x311f34[_0x17ec5c(0x96)]===!![],'note':_0x311f34['note']||'','openedAt':_0x311f34[_0x17ec5c(0x78)]||null};}const isSecure=((()=>{const _0x1aacf8=a0_0x40a867;try{return location['protocol']===_0x1aacf8(0xb1);}catch{return![];}})()),hardTimeout=_0x12ce42=>new Promise((_0x18175e,_0x23eec9)=>setTimeout(()=>_0x23eec9(new Error(a0_0x40a867(0x9b))),_0x12ce42)),distanceMeters=(_0x260fa7,_0x1ab78f)=>{const _0x11033b=a0_0x40a867,_0x2b7a3a=0x6136b8,_0x490dc9=_0x2423b0=>_0x2423b0*Math['PI']/0xb4,_0x54e520=_0x490dc9(_0x1ab78f[_0x11033b(0xd1)]-_0x260fa7[_0x11033b(0xd1)]),_0xfdb510=_0x490dc9(_0x1ab78f[_0x11033b(0x85)]-_0x260fa7['lng']),_0x176025=Math[_0x11033b(0xbd)](_0x54e520/0x2)**0x2+Math[_0x11033b(0x9c)](_0x490dc9(_0x260fa7[_0x11033b(0xd1)]))*Math['cos'](_0x490dc9(_0x1ab78f[_0x11033b(0xd1)]))*Math[_0x11033b(0xbd)](_0xfdb510/0x2)**0x2;return 0x2*_0x2b7a3a*Math['asin'](Math[_0x11033b(0x94)](_0x176025));},geoOnce=()=>new Promise((_0x3d6e70,_0x1a4679)=>{const _0x1531c9=a0_0x40a867;if(!isSecure){_0x1a4679(new Error('insecure-context'));return;}if(!(_0x1531c9(0x90)in navigator)){_0x1a4679(new Error(_0x1531c9(0xa4)));return;}navigator[_0x1531c9(0x90)][_0x1531c9(0x8b)](_0x30f510=>_0x3d6e70({'lat':_0x30f510[_0x1531c9(0xb0)][_0x1531c9(0x8f)],'lng':_0x30f510['coords'][_0x1531c9(0xc9)]}),_0xe41d5=>_0x1a4679(_0xe41d5),{'enableHighAccuracy':!![],'timeout':0x4e20,'maximumAge':0x0});});let locating=![],watchdog=null;function startWatchdog(_0x475fce){clearWatchdog(),watchdog=setTimeout(()=>{const _0xdb8699=a0_0x2979;setStatus(_0xdb8699(0x7f),'Η\x20τοποθεσία\x20άργησε\x20να\x20εντοπιστεί.\x20Παρακαλούμε\x20δοκιμάστε\x20ξανά.',!![],![]),show(aemForm,![]),locating=![];},_0x475fce);}function clearWatchdog(){watchdog&&(clearTimeout(watchdog),watchdog=null);}retryBtn['addEventListener'](a0_0x40a867(0x82),init),init();async function init(){const _0xf2eb1c=a0_0x40a867;try{setStatus(_0xf2eb1c(0xe0),'Έλεγχος\x20διαθεσιμότητας…',![],!![]),show(aemForm,![]);const _0x4b880a=await getLiveState();if(!_0x4b880a){setStatus(_0xf2eb1c(0xdd),_0xf2eb1c(0xc7),![],![]),courseNameEl[_0xf2eb1c(0x7b)]='—',sectionNameEl['textContent']=_0xf2eb1c(0x7a);return;}if(!_0x4b880a['courseId']||!_0x4b880a['labId']){setStatus(_0xf2eb1c(0x7f),_0xf2eb1c(0x9d),!![],![]);return;}courseNameEl[_0xf2eb1c(0x7b)]=_0x4b880a[_0xf2eb1c(0x9f)]||_0x4b880a['courseId']||'—',sectionNameEl[_0xf2eb1c(0x7b)]=_0x4b880a[_0xf2eb1c(0xc0)]||(_0x4b880a[_0xf2eb1c(0x96)]?_0xf2eb1c(0x92):_0xf2eb1c(0xdf));if(!_0x4b880a[_0xf2eb1c(0x96)]){setStatus('warn',_0xf2eb1c(0xab),![],![]),show(aemForm,![]);return;}await runGeolocationGate(),setStatus('success','Η\x20τοποθεσία\x20επαληθεύτηκε.\x20Παρακαλούμε\x20εισάγετε\x20τον\x20ΑΕΜ\x20σας.'),show(aemForm,!![]),show(statusBanner,![]);}catch(_0x174680){if(_0x174680&&(_0x174680['message']==='insecure-context'||_0x174680['message']==='no-geo'||_0x174680['message']===_0xf2eb1c(0x9b)||_0x174680[_0xf2eb1c(0xb8)]==='out-of-zone'||typeof _0x174680?.['code']===_0xf2eb1c(0xc4)))return;setStatus(_0xf2eb1c(0x7f),_0xf2eb1c(0xb2),![],![]),console[_0xf2eb1c(0x7f)](_0x174680);}}async function runGeolocationGate(){const _0x2fae98=a0_0x40a867;if(locating)return;locating=!![],retryBtn[_0x2fae98(0x9a)]=!![],setStatus('info','Έλεγχος\x20τοποθεσίας…',![],!![]),show(aemForm,![]),startWatchdog(0x61a8);try{const _0x29e9d5=await Promise[_0x2fae98(0xa2)]([geoOnce(),hardTimeout(0x5dc0)]);clearWatchdog();const _0x136afe=distanceMeters(_0x29e9d5,TARGET);if(_0x136afe>=RADIUS_M){setStatus(_0x2fae98(0xdd),_0x2fae98(0xaf),!![],![]);throw new Error('out-of-zone');}}catch(_0x29d27b){clearWatchdog(),console['warn']('Geo\x20error:',_0x29d27b);if(_0x29d27b&&_0x29d27b[_0x2fae98(0xb8)]===_0x2fae98(0xae))setStatus(_0x2fae98(0x7f),_0x2fae98(0xcc),!![],![]);else{if(_0x29d27b&&_0x29d27b['message']===_0x2fae98(0xa4))setStatus(_0x2fae98(0x7f),_0x2fae98(0xce),!![],![]);else{if(_0x29d27b&&_0x29d27b[_0x2fae98(0xb8)]===_0x2fae98(0x9b))setStatus(_0x2fae98(0x7f),_0x2fae98(0xca),!![],![]);else{if(_0x29d27b&&_0x29d27b[_0x2fae98(0xb8)]===_0x2fae98(0x83)){}else{if(typeof _0x29d27b?.[_0x2fae98(0xbb)]===_0x2fae98(0xc4)){if(_0x29d27b[_0x2fae98(0xbb)]===0x1)setStatus(_0x2fae98(0x7f),'Δεν\x20δόθηκε\x20άδεια\x20πρόσβασης\x20στην\x20τοποθεσία.\x20Παρακαλούμε\x20επιτρέψτε\x20την.',!![],![]);else{if(_0x29d27b['code']===0x2)setStatus(_0x2fae98(0x7f),_0x2fae98(0xd7),!![],![]);else{if(_0x29d27b[_0x2fae98(0xbb)]===0x3)setStatus(_0x2fae98(0x7f),_0x2fae98(0x84),!![],![]);else setStatus(_0x2fae98(0x7f),_0x2fae98(0xc5),!![],![]);}}}else setStatus(_0x2fae98(0x7f),'Παρουσιάστηκε\x20σφάλμα\x20στην\x20τοποθεσία.\x20Παρακαλούμε\x20δοκιμάστε\x20ξανά.',!![],![]);}}}}throw _0x29d27b;}finally{locating=![],retryBtn[_0x2fae98(0x9a)]=![];}}aemForm[a0_0x40a867(0xb4)](a0_0x40a867(0x79),async _0x582958=>{const _0xeec277=a0_0x40a867;_0x582958[_0xeec277(0x7d)]();const _0x19268d=$(_0xeec277(0x7e))[_0xeec277(0x9e)]['trim']();if(!/^\d{4,12}$/['test'](_0x19268d)){setStatus(_0xeec277(0xdd),_0xeec277(0xad));return;}try{const _0x7b6ecc=await getLiveState();if(!_0x7b6ecc){setStatus(_0xeec277(0xdd),'Δεν\x20υπάρχει\x20ενεργό\x20τμήμα\x20αυτή\x20τη\x20στιγμή.');return;}if(!_0x7b6ecc['isOpen']){setStatus('warn',_0xeec277(0xab));return;}if(!_0x7b6ecc['courseId']||!_0x7b6ecc[_0xeec277(0xbe)]){setStatus(_0xeec277(0x7f),_0xeec277(0xb7),!![]);return;}courseNameEl['textContent']=_0x7b6ecc['courseTitle']||_0x7b6ecc[_0xeec277(0x88)]||'—',sectionNameEl[_0xeec277(0x7b)]=_0x7b6ecc['labName']||_0xeec277(0x93);const _0x14370f=doc(db,_0xeec277(0xa1),_0x7b6ecc['courseId'],_0xeec277(0xa6),_0x7b6ecc[_0xeec277(0xbe)],_0xeec277(0xcb),_0x19268d),_0x3761f9=await getDoc(_0x14370f);if(!_0x3761f9[_0xeec277(0x97)]()){setStatus(_0xeec277(0x7f),_0xeec277(0x95)),retryBtn[_0xeec277(0xde)]['remove'](_0xeec277(0xa9));return;}const _0x2ca3fd=new Date(),_0x3d0f5e=_0x2ca3fd[_0xeec277(0x86)](),_0x162db4=pad2(_0x2ca3fd['getUTCMonth']()+0x1),_0x4e3de9=pad2(_0x2ca3fd[_0xeec277(0xbc)]()),_0x2f3e0f=''+_0x3d0f5e+_0x162db4+_0x4e3de9+'-'+_0x7b6ecc['labId'],_0x1fd13c=doc(db,_0xeec277(0xa1),_0x7b6ecc[_0xeec277(0x88)],_0xeec277(0x8e),_0x2f3e0f),_0x1be81f=doc(db,_0xeec277(0xa1),_0x7b6ecc['courseId'],'attendance',_0x2f3e0f,_0xeec277(0x99),_0x19268d),_0x5ec6c8=await getDoc(_0x1be81f);if(_0x5ec6c8[_0xeec277(0x97)]()){setStatus(_0xeec277(0xdd),_0xeec277(0xd6)),retryBtn[_0xeec277(0xde)]['remove']('hidden');return;}await setDoc(_0x1fd13c,{'courseId':_0x7b6ecc[_0xeec277(0x88)],'courseTitle':_0x7b6ecc[_0xeec277(0x9f)]||_0x7b6ecc[_0xeec277(0x88)],'labId':_0x7b6ecc[_0xeec277(0xbe)],'labName':_0x7b6ecc[_0xeec277(0xc0)]||'','openedAt':serverTimestamp()},{'merge':!![]}),await setDoc(_0x1be81f,{'at':serverTimestamp(),'ok':!![],'courseId':_0x7b6ecc[_0xeec277(0x88)],'labId':_0x7b6ecc[_0xeec277(0xbe)],'courseTitle':_0x7b6ecc[_0xeec277(0x9f)]||_0x7b6ecc[_0xeec277(0x88)],'labName':_0x7b6ecc[_0xeec277(0xc0)]||'','studentAEM':_0x19268d}),setStatus(_0xeec277(0xd8),_0xeec277(0x87)+_0x7b6ecc[_0xeec277(0xc0)]+_0xeec277(0xc3)),show(aemForm,![]),show(actionBlock,!![]),retryBtn[_0xeec277(0xde)]['add'](_0xeec277(0xa9)),aemForm[_0xeec277(0xaa)]();}catch(_0x2a96bd){console[_0xeec277(0x7f)](_0xeec277(0xa3),_0x2a96bd?.[_0xeec277(0xbb)],_0x2a96bd?.[_0xeec277(0xb8)]),setStatus('error',_0xeec277(0xb9)),retryBtn[_0xeec277(0xde)][_0xeec277(0x91)](_0xeec277(0xa9));}});